<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>PlanetaTurismo.com</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="validator.js" />
    <link rel="stylesheet" href="index.js" />

  </head>
<body>

  <script type="text/javascript" src="index.js"> </script>

    <center><header>FORMA DE PAGAMENTO</header></center>
    
    <br>

    <div class="h1-container"><center><strong><h1>PLANETA TURISMO</h1></strong></div></center>

    </br>

    <div class="imagem">

    <div class="container">

    <center><h2>Para finalizar sua compra, precisamos que confirme os dados abaixo:</h2></center>

<form>

<ul>
  <br>

  <label for="inputcodigoNome">Insira seu nome completo:</label>

  <input type="text" id="inputcodigoNome" name="inputcodigoNome" placeholder= "nome completo" required>

  <label for="inputcodigoCartao">Insira o número do cartão:</label>

  <input type="text" id="inputcodigoCartao" name="inputcodigoCartao" placeholder= "cartão de crédito" required>

</br>
  <br>

     <button id="submit" onclick=validarCartao()>Confirmar</button></div>

</br>
</ul>

</form>

</body>

</html>

<script>

function maskify(codigoCartao) {

const caracteresEscondidos = 12;
const caracteresVisiveis = codigoCartao.length - caracteresEscondidos;
const caracteresEscondidosStr = "#".repeat(caracteresEscondidos);
const caracteresVisiveisStr = codigoCartao.slice(-caracteresVisiveis);
return caracteresEscondidosStr + caracteresVisiveisStr;
}

function isValid(codigoCartao) {

const numeroCartaoLimpo = codigoCartao.replace(/\D/g, "");
if (numeroCartaoLimpo.length < 16 || numeroCartaoLimpo.length > 16) {
  return false;
}
const somaDigitos = numeroCartaoLimpo.split("").reverse().reduce((acc, digit, idx) => {
const valor = parseInt(digit, 10);
if (idx % 2 === 0) {
 acc += valor;
} else {
const resultadoMultiplicacao = valor * 2;
 acc += resultadoMultiplicacao > 9 ? resultadoMultiplicacao.toString().split("").reduce((sum, d) => sum + parseInt(d), 0) : resultadoMultiplicacao;
}
return acc;
}, 0);

return somaDigitos % 10 === 0;
}

function validarCartao() {
const codigoCartao = document.getElementById("inputcodigoCartao").value;
const nomecomplet = document.getElementById("inputcodigoNome").value
const codigoMascarado = maskify(codigoCartao);
const valido = isValid(codigoCartao);

if (valido) {
  alert(`Obaa! ${nomecomplet} sua compra no cartão ${codigoMascarado} foi aprovada com sucesso.`);
} else {
  alert(`Olá, ${nomecomplet}! O número de cartão ${codigoMascarado} é inválido. Verifique os dados adicionados e tente novamente.`);
}
}

  console.log(`Nome Completo: ${nomecomplet}`);
  console.log(`Código do Cartão: ${codigoCartao}`);
  console.log(`Código de Cartão (Mascarado): ${codigoMascarado}`);
  console.log(`Cartão Válido: ${valido}`);

</script>